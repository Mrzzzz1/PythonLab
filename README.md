# PythonLab
## 烂番茄电影情感分类
使用pytorch实现电影评论语句五分类
## 流程
### 读取数据
使用 csv.reader() 从 train.tsv 中读取数据，使用 tokenlize() 函数对每个句子进行序列化，转化为字符串数组，序列化的同时去除标点和某些常见无意义的词。将电影评论数据分为训练集和测试集两部分，其中训练集占比90%，用于训练模型，测试集占10%，用于测试训练后的模型。使用两个 DataSet 储存句子和标签，用于后续训练和测试

### 训练模型  
1. 建立词库
遍历训练集，根据训练集中出现的单词建立词库，得出单词和数字的一一对应关系。
2. word2Vector
根据词库中的键值对将测试集中的字符串序列转化为数字序列。序列需统一选择长度，长度小于选择长度的使用填充字符填充，长度大于选择长度的截取为统一长度。
3. 模型训练
使用 MyModule 类进行训练。首先用embedding对数字序列进行升维，从而起到特征放大的作用。序列在经过 GRU 层和 Linear 层后得到 output ，使用根 CrossEntropyLoss 根据 output 和target 计算 loss , 使用 optimizer.zero_grad() 清除梯度，再使用 loss.backward() 进行反向传播，最后使用 optimizer.step() 更新模型参数。
### 测试模型
使用测试集数据对训练好的模型进行测试，除不用计算梯度和 loss 外，过程与训练模型相同。将 output 的输出值最大所在的下标作为预测的标签，与 target 比较算出正确率即可。
